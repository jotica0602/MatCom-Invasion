#include "visuals.h"
#include <unistd.h>

void display_welcome_screen(){
    printf("\n\t\t\t\tWELCOME SOLDIER! \n \n");
    sleep(2);
    printf("\tTHE COMMAND PROMPT INVADERS ARE BACK AND EVERYONE NEEDS A HERO \n \n ");
    sleep(2);
    printf("\t\tDEFEND YOUR OPERATING SYSTEM NO MATTER WHAT\n \n");
    sleep(2);
    printf("\t\t\t\t MOVE WITH <- ->\n\n");
    sleep(2);
    printf("\t\t\t      SHOOT WITH SPACEBAR\n\n");
    sleep(2);
    printf("\t\t\t\t GOOD LUCK!!!\n\n");
    sleep(2);
    printf("\n\n\t\t\t   PRESS ANY KEY TO START");
    getchar();
}

void draw_screen(){
    system("clear");
    print_game_title();
    // pthread_mutex_lock(&grid_lock);

    /*
    \033[0;30m: Negro
    \033[0;31m: Rojo
    \033[0;32m: Verde
    \033[0;33m: Amarillo
    \033[0;34m: Azul
    \033[0;35m: Magenta
    \033[0;36m: Cian
    \033[0;37m: Blanco 
    */   
   
    for (int i = 0; i < ROWS; i++){
        for (int j = 0; j < COLS; j++){
            switch(grid[i][j]){
                case 'A':
                    printf("\033[1;32m%2c\033[0m", grid[i][j]);
                    break;
                
                case '1':
                    printf("\033[1;35m%2c\033[0m", 'M');
                    break;
                
                case '2':
                    printf("\033[1;32m%2c\033[0m", 'M');
                    break;
                
                case '3':
                    printf("\033[1;36m%2c\033[0m", 'M');
                    break;
                
                case '4':
                    printf("\033[1;33m%2c\033[0m", 'M');
                    break;

                case '5':
                    printf("%2c", '#');
                    break;

                case '6':
                    printf("\033[1;31m%2c\033[0m", 'W');
                    break;
                
                case '*':
                    printf("\033[1;37m%2c\033[0m", grid[i][j]);
                    break;
                
                case '^':
                    printf("\033[1;33m%2c\033[0m", grid[i][j]);
                    break;
                
                case 'X':
                    printf("\033[1;37m%2c\033[0m", grid[i][j]);
                    break;

                case '|':
                    printf("\033[1;37m%2s\033[0m", "█");
                    break;
                
                case '-':
                    printf("%2c", ' ');
                    break;

                default:
                    printf("%2c", grid[i][j]);
                    break;
            }
        }
        printf("\n");
    }
    printf("\n\033[1;37mScore:\033[0m\033[1;33m%-d\033[0m-------------------------\033[1;37mLevel:%d\033[0m------------------------\033[1;37mLives:\033[0m\033[1;31m%d\033[0m\t\t\t\n", g_score, g_current_level, g_player_hp);
    printf("\t\t\t     \033[1;33mHigh Score:%d\033[0m\n", g_high_score);
    // pthread_mutex_unlock(&grid_lock);
}

void print_game_title(){
    printf("\t\033[1;37m█▀▄▀█ ▄▀█ ▀█▀ █▀▀ █▀█ █▀▄▀█   █ █▄░█ █░█ ▄▀█ █▀ █ █▀█ █▄░█\033[0m\n");
    printf("\t\033[1;37m█░▀░█ █▀█ ░█░ █▄▄ █▄█ █░▀░█   █ █░▀█ ▀▄▀ █▀█ ▄█ █ █▄█ █░▀█\033[0m\n");
    // printf("███╗░░░███╗░█████╗░████████╗░█████╗░░█████╗░███╗░░░███╗  ██╗███╗░░██╗██╗░░░██╗░█████╗░░██████╗██╗░█████╗░███╗░░██╗\n");
    // printf("████╗░████║██╔══██╗╚══██╔══╝██╔══██╗██╔══██╗████╗░████║  ██║████╗░██║██║░░░██║██╔══██╗██╔════╝██║██╔══██╗████╗░██║\n");
    // printf("██╔████╔██║███████║░░░██║░░░██║░░╚═╝██║░░██║██╔████╔██║  ██║██╔██╗██║╚██╗░██╔╝███████║╚█████╗░██║██║░░██║██╔██╗██║\n");
    // printf("██║╚██╔╝██║██╔══██║░░░██║░░░██║░░██╗██║░░██║██║╚██╔╝██║  ██║██║╚████║░╚████╔╝░██╔══██║░╚═══██╗██║██║░░██║██║╚████║\n");
    // printf("██║░╚═╝░██║██║░░██║░░░██║░░░╚█████╔╝╚█████╔╝██║░╚═╝░██║  ██║██║░╚███║░░╚██╔╝░░██║░░██║██████╔╝██║╚█████╔╝██║░╚███║\n");
    // printf("╚═╝░░░░░╚═╝╚═╝░░╚═╝░░░╚═╝░░░░╚════╝░░╚════╝░╚═╝░░░░░╚═╝  ╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚═╝░░╚═╝╚═════╝░╚═╝░╚════╝░╚═╝░░╚══╝\n");
    // const char *r1 = "\t$$\\      $$\\            $$\\      $$$$$$\\                                $$$$$$\\                                        $$\\                     \n";
    // const char *r2 = "\t$$$\\    $$$ |           $$ |    $$  __$$\\                               \\_$$  _|                                       \\__|                    \n";
    // const char *r3 = "\t$$$$\\  $$$$ | $$$$$$\\ $$$$$$\\   $$ /  \\__| $$$$$$\\  $$$$$$\\$$$$\\          $$ |  $$$$$$$\\ $$\\    $$\\ $$$$$$\\   $$$$$$$\\ $$\\  $$$$$$\\  $$$$$$$\\  \n";
    // const char *r4 = "\t$$\\$$\\$$ $$ | \\____$$\\\\_$$  _|  $$ |      $$  __$$\\ $$  _$$  _$$\\         $$ |  $$  __$$\\\\$$\\  $$  |\\____$$\\ $$  _____|$$ |$$  __$$\\ $$  __$$\\ \n";
    // const char *r5 = "\t$$ \\$$$  $$ | $$$$$$$ | $$ |    $$ |      $$ /  $$ |$$ / $$ / $$ |        $$ |  $$ |  $$ |\\$$\\$$  / $$$$$$$ |\\$$$$$$\\  $$ |$$ /  $$ |$$ |  $$ |\n";
    // const char *r6 = "\t$$ |\\$  /$$ |$$  __$$ | $$ |$$\\ $$ |  $$\\ $$ |  $$ |$$ | $$ | $$ |        $$ |  $$ |  $$ | \\$$$  / $$  __$$ | \\____$$\\ $$ |$$ |  $$ |$$ |  $$ |\n";
    // const char *r7 = "\t$$ | \\_/ $$ |\\$$$$$$$ | \\$$$$  |\\$$$$$$  |\\$$$$$$  |$$ | $$ | $$ |      $$$$$$\\ $$ |  $$ |  \\$  /  \\$$$$$$$ |$$$$$$$  |$$ |\\$$$$$$  |$$ |  $$ |\n";
    // const char *r8 = "\t\\__|     \\__| \\_______|  \\____/  \\______/  \\______/ \\__| \\__| \\__|      \\______|\\__|  \\__|   \\_/    \\_______|\\_______/ \\__| \\______/ \\__|  \\__|\n";

    // printf("%s",r1);
    // printf("%s",r2);
    // printf("%s",r3);
    // printf("%s",r4);
    // printf("%s",r5);
    // printf("%s",r6);
    // printf("%s",r7);
    // printf("%s",r8);
    
}

// ███╗░░░███╗░█████╗░████████╗░█████╗░░█████╗░███╗░░░███╗  ██╗███╗░░██╗██╗░░░██╗░█████╗░░██████╗██╗░█████╗░███╗░░██╗
// ████╗░████║██╔══██╗╚══██╔══╝██╔══██╗██╔══██╗████╗░████║  ██║████╗░██║██║░░░██║██╔══██╗██╔════╝██║██╔══██╗████╗░██║
// ██╔████╔██║███████║░░░██║░░░██║░░╚═╝██║░░██║██╔████╔██║  ██║██╔██╗██║╚██╗░██╔╝███████║╚█████╗░██║██║░░██║██╔██╗██║
// ██║╚██╔╝██║██╔══██║░░░██║░░░██║░░██╗██║░░██║██║╚██╔╝██║  ██║██║╚████║░╚████╔╝░██╔══██║░╚═══██╗██║██║░░██║██║╚████║
// ██║░╚═╝░██║██║░░██║░░░██║░░░╚█████╔╝╚█████╔╝██║░╚═╝░██║  ██║██║░╚███║░░╚██╔╝░░██║░░██║██████╔╝██║╚█████╔╝██║░╚███║
// ╚═╝░░░░░╚═╝╚═╝░░╚═╝░░░╚═╝░░░░╚════╝░░╚════╝░╚═╝░░░░░╚═╝  ╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚═╝░░╚═╝╚═════╝░╚═╝░╚════╝░╚═╝░░╚══╝

// $$\      $$\            $$\      $$$$$$\                                $$$$$$\                                        $$\                     
// $$$\    $$$ |           $$ |    $$  __$$\                               \_$$  _|                                       \__|                    
// $$$$\  $$$$ | $$$$$$\ $$$$$$\   $$ /  \__| $$$$$$\  $$$$$$\$$$$\          $$ |  $$$$$$$\ $$\    $$\ $$$$$$\   $$$$$$$\ $$\  $$$$$$\  $$$$$$$\  
// $$\$$\$$ $$ | \____$$\\_$$  _|  $$ |      $$  __$$\ $$  _$$  _$$\         $$ |  $$  __$$\\$$\  $$  |\____$$\ $$  _____|$$ |$$  __$$\ $$  __$$\ 
// $$ \$$$  $$ | $$$$$$$ | $$ |    $$ |      $$ /  $$ |$$ / $$ / $$ |        $$ |  $$ |  $$ |\$$\$$  / $$$$$$$ |\$$$$$$\  $$ |$$ /  $$ |$$ |  $$ |
// $$ |\$  /$$ |$$  __$$ | $$ |$$\ $$ |  $$\ $$ |  $$ |$$ | $$ | $$ |        $$ |  $$ |  $$ | \$$$  / $$  __$$ | \____$$\ $$ |$$ |  $$ |$$ |  $$ |
// $$ | \_/ $$ |\$$$$$$$ | \$$$$  |\$$$$$$  |\$$$$$$  |$$ | $$ | $$ |      $$$$$$\ $$ |  $$ |  \$  /  \$$$$$$$ |$$$$$$$  |$$ |\$$$$$$  |$$ |  $$ |
// \__|     \__| \_______|  \____/  \______/  \______/ \__| \__| \__|      \______|\__|  \__|   \_/    \_______|\_______/ \__| \______/ \__|  \__|

void print_game_over(){
    printf("\n\t \t\033[1;31m█▀▀ ▄▀█ █▀▄▀█ █▀▀   █▀█ █░█ █▀▀ █▀█\033[0m\n");
    printf("\t \t\033[1;31m█▄█ █▀█ █░▀░█ ██▄   █▄█ ▀▄▀ ██▄ █▀▄\033[0m\n\n");
    // const char *r1 = "\t\t\t\t$$$$$$\\                                           $$$$$$\\                                 \n";
    // const char *r2 = "\t\t\t\t$$  __$$\\                                         $$  __$$\\                                \n";
    // const char *r3 = "\t\t\t\t$$ /  \\__| $$$$$$\\  $$$$$$\\$$$$\\   $$$$$$\\        $$ /  $$ |$$\\    $$\\  $$$$$$\\   $$$$$$\\  \n";
    // const char *r4 = "\t\t\t\t$$ |$$$$\\  \\____$$\\ $$  _$$  _$$\\ $$  __$$\\       $$ |  $$ |\\$$\\  $$  |$$  __$$\\ $$  __$$\\ \n";
    // const char *r5 = "\t\t\t\t$$ |\\_$$ | $$$$$$$ |$$ / $$ / $$ |$$$$$$$$ |      $$ |  $$ | \\$$\\$$  / $$$$$$$$ |$$ |  \\__|\n";
    // const char *r6 = "\t\t\t\t$$ |  $$ |$$  __$$ |$$ | $$ | $$ |$$   ____|      $$ |  $$ |  \\$$$  /  $$   ____|$$ |      \n";
    // const char *r7 = "\t\t\t\t\\$$$$$$  |\\$$$$$$$ |$$ | $$ | $$ |\\$$$$$$$\\        $$$$$$  |   \\$  /   \\$$$$$$$\\ $$ |      \n";
    // const char *r8 = "\t\t\t\t\\______/  \\_______|\\__| \\__| \\__| \\_______|       \\______/     \\_/     \\_______|\\__|      \n";

    // printf("%s",r1);
    // printf("%s",r2);
    // printf("%s",r3);
    // printf("%s",r4);
    // printf("%s",r5);
    // printf("%s",r6);
    // printf("%s",r7);
    // printf("%s",r8);
}

// $$$$$$\                                           $$$$$$\                                 
// $$  __$$\                                         $$  __$$\                                
// $$ /  \__| $$$$$$\  $$$$$$\$$$$\   $$$$$$\        $$ /  $$ |$$\    $$\  $$$$$$\   $$$$$$\  
// $$ |$$$$\  \____$$\ $$  _$$  _$$\ $$  __$$\       $$ |  $$ |\$$\  $$  |$$  __$$\ $$  __$$\ 
// $$ |\_$$ | $$$$$$$ |$$ / $$ / $$ |$$$$$$$$ |      $$ |  $$ | \$$\$$  / $$$$$$$$ |$$ |  \__|
// $$ |  $$ |$$  __$$ |$$ | $$ | $$ |$$   ____|      $$ |  $$ |  \$$$  /  $$   ____|$$ |      
// \$$$$$$  |\$$$$$$$ |$$ | $$ | $$ |\$$$$$$$\        $$$$$$  |   \$  /   \$$$$$$$\ $$ |      
//  \______/  \_______|\__| \__| \__| \_______|       \______/     \_/     \_______|\__|      



void print_level_completed() {
    printf("\t\033[1;32m█░░ █▀▀ █░█ █▀▀ █░░   █▀▀ █▀█ █▀▄▀█ █▀█ █░░ █▀▀ ▀█▀ █▀▀ █▀▄\033[0m\n");
    printf("\t\033[1;32m█▄▄ ██▄ ▀▄▀ ██▄ █▄▄   █▄▄ █▄█ █░▀░█ █▀▀ █▄▄ ██▄ ░█░ ██▄ █▄▀\033[0m\n\n");
    // printf("\t\t$$\\                                      $$\\        $$$$$$\\                                    $$\\             $$\\                     $$\\ \n");
    // printf("\t\t$$ |                                     $$ |      $$  __$$\\                                   $$ |            $$ |                    $$ |\n");
    // printf("\t\t$$ |       $$$$$$\\  $$\\    $$\\  $$$$$$\\  $$ |      $$ /  \\__| $$$$$$\\  $$$$$$\\$$$$\\   $$$$$$\\  $$ | $$$$$$\\  $$$$$$\\    $$$$$$\\   $$$$$$$ |\n");
    // printf("\t\t$$ |      $$  __$$\\ \\$$\\  $$  |$$  __$$\\ $$ |      $$ |      $$  __$$\\ $$  _$$  _$$\\ $$  __$$\\ $$ |$$  __$$\\ \\_$$  _|  $$  __$$\\ $$  __$$ |\n");
    // printf("\t\t$$ |      $$$$$$$$ | \\$$\\$$  / $$$$$$$$ |$$ |      $$ |      $$ /  $$ |$$ / $$ / $$ |$$ /  $$ |$$ |$$$$$$$$ |  $$ |    $$$$$$$$ |$$ /  $$ |\n");
    // printf("\t\t$$ |      $$   ____|  \\$$$  /  $$   ____|$$ |      $$ |  $$\\ $$ |  $$ |$$ | $$ | $$ |$$ |  $$ |$$ |$$   ____|  $$ |$$\\ $$   ____|$$ |  $$ |\n");
    // printf("\t\t$$$$$$$$\\ \\$$$$$$$\\    \\$  /   \\$$$$$$$\\ $$ |      \\$$$$$$  |\\$$$$$$  |$$ | $$ | $$ |$$$$$$$  |$$ |\\$$$$$$$\\   \\$$$$  |\\$$$$$$$\\ \\$$$$$$$ |\n");
    // printf("\t\t\\________| \\_______|    \\_/     \\_______|\\__|       \\______/  \\______/ \\__| \\__| \\__|$$  ____/ \\__| \\_______|   \\____/  \\_______| \\_______|\n");
    // printf("\t\t                                                                                     $$ |                                                  \n");
    // printf("\t\t                                                                                     $$ |                                                  \n");
    // printf("\t\t                                                                                     \\__|                                                  \n");
}

// $$\                                      $$\        $$$$$$\                                    $$\             $$\                     $$\ 
// $$ |                                     $$ |      $$  __$$\                                   $$ |            $$ |                    $$ |
// $$ |       $$$$$$\  $$\    $$\  $$$$$$\  $$ |      $$ /  \__| $$$$$$\  $$$$$$\$$$$\   $$$$$$\  $$ | $$$$$$\  $$$$$$\    $$$$$$\   $$$$$$$ |
// $$ |      $$  __$$\ \$$\  $$  |$$  __$$\ $$ |      $$ |      $$  __$$\ $$  _$$  _$$\ $$  __$$\ $$ |$$  __$$\ \_$$  _|  $$  __$$\ $$  __$$ |
// $$ |      $$$$$$$$ | \$$\$$  / $$$$$$$$ |$$ |      $$ |      $$ /  $$ |$$ / $$ / $$ |$$ /  $$ |$$ |$$$$$$$$ |  $$ |    $$$$$$$$ |$$ /  $$ |
// $$ |      $$   ____|  \$$$  /  $$   ____|$$ |      $$ |  $$\ $$ |  $$ |$$ | $$ | $$ |$$ |  $$ |$$ |$$   ____|  $$ |$$\ $$   ____|$$ |  $$ |
// $$$$$$$$\ \$$$$$$$\    \$  /   \$$$$$$$\ $$ |      \$$$$$$  |\$$$$$$  |$$ | $$ | $$ |$$$$$$$  |$$ |\$$$$$$$\   \$$$$  |\$$$$$$$\ \$$$$$$$ |
// \________| \_______|    \_/     \_______|\__|       \______/  \______/ \__| \__| \__|$$  ____/ \__| \_______|   \____/  \_______| \_______|
//                                                                                      $$ |                                                  
//                                                                                      $$ |                                                  
//                                                                                      \__|                                                  

void clean_explosions(){
    for(int i = 1; i < ROWS - 3;i++){
        for(int j = 1; j < COLS - 1; j++){
            if(grid[i][j] == 'X'){
                grid[i][j] = ' ';
            }
        }
    }
}

void *explosions_cleaner_routine(void *params){
    while(!terminate){
        pthread_mutex_lock(&grid_lock);
        clean_explosions();
        pthread_mutex_unlock(&grid_lock);
        usleep(500000);
    }
    return NULL;
}